import{e as V,u as q,L as X,a as B,Q as I,r as b,o as E,i as _,j as $,k as i,l as c,q as o,S as k,U as C,a1 as N,p as d,t as s,X as P,Y as U,a2 as j,s as g,m as e,v as z,x as F,F as M,A as G,a3 as T,a4 as A}from"./vendor.b28878af.js";import{u as S}from"./index.f23bfad6.js";const J={emits:["reload","close"],setup(D,{emit:w}){const{t:r}=V(),{cookies:m}=q(),h=X(),t=B.create({validateStatus:()=>!0}),l=S(),n=I(!1),v=I(null),a=b({username:"",email:"",profile:""});E(()=>{a.username=l.account.accountProfile.username,a.email=l.account.accountProfile.email,a.profile=JSON.stringify(l.account.accountProfile.profile,null,4)});function L(){var u;(u=v.value)==null||u.validate(f=>{if(!f){let p;try{p=JSON.parse(a.profile)}catch{h.error("Failed to update profile, your profile scheme is error!");return}n.value=!0,t.patch("/api/management/users",{username:a.username,email:a.email,profile:p},{headers:{Authorization:"Bearer "+m.get("access_token")}}).catch(()=>{h.error(r("common.message.request-unknown-error")),n.value=!1}).then(y=>{y.status===200?(h.success(r("user.profile.editor.messages.success")),w("reload"),w("close")):(h.error(r("common.messages.request-unknown-error")),console.error("Request error: ",y)),n.value=!1})}})}return(u,f)=>(_(),$(o(j),{style:{width:"600px"},title:u.$t("user.profile.editor.title"),bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:i(()=>[c(o(U),{ref_key:"form",ref:v},{default:i(()=>[c(o(k),{label:u.$t("user.profile.overview.username"),required:""},{default:i(()=>[c(o(C),{value:o(a).username,"onUpdate:value":f[0]||(f[0]=p=>o(a).username=p)},null,8,["value"])]),_:1},8,["label"]),c(o(k),{label:u.$t("user.profile.overview.email"),required:""},{default:i(()=>[c(o(N),{trigger:"hover"},{trigger:i(()=>[c(o(C),{value:o(a).email,"onUpdate:value":f[1]||(f[1]=p=>o(a).email=p),disabled:""},null,8,["value"])]),default:i(()=>[d(" "+s(u.$t("user.profile.editor.messages.edit-email")),1)]),_:1})]),_:1},8,["label"]),c(o(k),{label:u.$t("user.profile.overview.profile")},{default:i(()=>[c(o(C),{value:o(a).profile,"onUpdate:value":f[2]||(f[2]=p=>o(a).profile=p),type:"textarea"},null,8,["value"])]),_:1},8,["label"]),c(o(P),{loading:n.value,style:{width:"100%"},type:"primary",onClick:L},{default:i(()=>[d(s(u.$t("common.actions.update")),1)]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["title"]))}},O={class:"container"},R={class:"text-secondary"},Q={key:0},Y={class:"text-warning"},H={class:"p-2"},K={class:"card"},W={class:"card-body p-4"},Z={class:"row"},x={class:"col-4"},ee={class:"col-8"},oe={class:"row"},se={class:"col-4"},te={class:"col-8"},re={class:"row"},le={class:"col-4"},ie={class:"col-8"},ae=e("hr",null,null,-1),ne={class:"row"},ce={class:"col-4"},ue={class:"col-8"},de={class:"row"},ve={class:"col-4"},fe={class:"col-8"},pe={class:"row"},_e={class:"col-4"},me={class:"col-8"},he={class:"row"},we={class:"col-4"},ge={class:"col-8"},$e={key:0},ye={class:"text-warning"},ke=e("hr",null,null,-1),Ce={class:"row"},Ne={class:"col-4"},Pe={class:"col-8"},Ie=e("hr",null,null,-1),Xe={class:"row"},be={class:"col-4"},Se={class:"col-8"},De={class:"row pt-1"},Le={class:"col-4"},Ve={class:"col-8"},qe={class:"card mt-4"},Be={class:"card-body p-4"},Ee={class:"row"},Ue={class:"col-4"},je={class:"col-8"},ze=d("\xA0 "),Ge={setup(D){const w=X(),r=S(),m=b({profileEditor:!1});function h(t){if(isNaN(t))return NaN;let l=String(+t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],v="",a=3;for(;a--;)v=(n[+l.pop()+a*10]||"")+v;return Array(+l.join("")+1).join("M")+v}return(t,l)=>(_(),g("div",O,[e("h3",null,s(o(r).account.accountProfile.username),1),e("h6",R,[d(" Lv."+s(h(o(r).account.accountProfile.level))+" "+s(o(r).account.accountProfile.level_experience)+"/"+s(o(r).account.accountProfile.level*1200)+" ",1),o(r).account.accountProfile.level<4?(_(),g("span",Q,s(t.$t("user.profile.level.ranks."+(o(r).account.accountProfile.level-1))),1)):(_(),$(o(N),{key:1,trigger:"hover"},{trigger:i(()=>[e("span",Y,s(t.$t("user.profile.level.end-rank")),1)]),default:i(()=>[d(" "+s(t.$t("user.profile.level.nomore-ranks")),1)]),_:1}))]),e("div",H,[e("div",K,[e("div",W,[e("div",Z,[e("div",x,s(t.$t("user.profile.overview.username")),1),e("div",ee,s(o(r).account.accountProfile.username),1)]),e("div",oe,[e("div",se,s(t.$t("user.profile.overview.email")),1),e("div",te,s(o(r).account.accountProfile.email),1)]),e("div",re,[e("div",le,s(t.$t("user.profile.overview.join")),1),e("div",ie,s(new Date(o(r).account.accountProfile.created_at).toUTCString()),1)]),ae,e("div",ne,[e("div",ce,s(t.$t("user.profile.overview.level")),1),e("div",ue,s(o(r).account.accountProfile.level),1)]),e("div",de,[e("div",ve,s(t.$t("user.profile.overview.exp")),1),e("div",fe,s(o(r).account.accountProfile.level_experience),1)]),e("div",pe,[e("div",_e,s(t.$t("user.profile.overview.upgrade")),1),e("div",me,s(o(r).account.accountProfile.level*1200),1)]),e("div",he,[e("div",we,s(t.$t("user.profile.overview.rank")),1),e("div",ge,[o(r).account.accountProfile.level<4?(_(),g("span",$e,s(t.$t("user.profile.level.ranks"+(o(r).account.accountProfile.level-1))),1)):(_(),$(o(N),{key:1,trigger:"hover"},{trigger:i(()=>[e("span",ye,s(t.$t("user.profile.level.end-rank")),1)]),default:i(()=>[d(" "+s(t.$t("user.profile.level.nomore-ranks")),1)]),_:1}))])]),ke,e("div",Ce,[e("div",Ne,s(t.$t("user.profile.overview.profile")),1),e("div",Pe,[e("code",null,[e("pre",null,"                  "+s(JSON.stringify(o(r).account.accountProfile.profile,null,4))+`
                `,1)])])]),Ie,e("div",Xe,[e("div",be,s(t.$t("user.profile.overview.group")),1),e("div",Se,s(o(r).account.accountGroup?o(r).account.accountGroup.name:"Didn't join group yet."),1)]),z(e("div",null,[e("div",De,[e("div",Le,s(t.$t("user.profile.overview.permission")),1),e("div",Ve,[(_(!0),g(M,null,G(o(r).account.accountGroup.permissions,(n,v)=>(_(),$(o(A),{key:v},{default:i(()=>[d(s(n),1)]),_:2},1024))),128))])])],512),[[F,o(r).account.accountGroup!=null]])])]),e("div",qe,[e("div",Be,[e("div",Ee,[e("div",Ue,s(t.$t("user.profile.overview.account")),1),e("div",je,[c(o(P),{size:"tiny",secondary:"",type:"warning",onClick:l[0]||(l[0]=n=>o(m).profileEditor=!0)},{default:i(()=>[d(s(t.$t("user.profile.overview.actions.edit-account")),1)]),_:1}),ze,c(o(P),{size:"tiny",secondary:"",type:"error",onClick:l[1]||(l[1]=n=>o(w).info(t.$t("user.profile.overview.actions.delete-account-cannot")))},{default:i(()=>[d(s(t.$t("user.profile.overview.actions.delete-account")),1)]),_:1})])])])])]),c(o(T),{show:o(m).profileEditor,"onUpdate:show":l[4]||(l[4]=n=>o(m).profileEditor=n)},{default:i(()=>[c(J,{onReload:l[2]||(l[2]=n=>o(r).init()),onClose:l[3]||(l[3]=n=>o(m).profileEditor=!1)})]),_:1},8,["show"])]))}};export{Ge as default};
