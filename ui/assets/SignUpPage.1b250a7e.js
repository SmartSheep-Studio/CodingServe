import{f as P,b as U,z as N,A as w,C as V,g as y,l as h,i,j as t,k as r,M as k,w as l,G as C,O as u,P as m,Q as f,R as p,S as x,U as F,p as c}from"./vendor.19b3a550.js";import{_ as K}from"./index.1c04caea.js";const A={class:"container-fluid row",style:{height:"100%"}},R={class:"col-lg-3 col-md-4 col-sm-5 position-absolute top-50 start-50 translate-middle"},z=i("h4",{class:"text-center",style:{"line-height":"60px"}},[i("img",{alt:"LumbaShark",height:"80",src:K,width:"80"})],-1),B={class:"card"},D={key:0,class:"card-body"},I=i("h6",{class:"text-center"},"Sign Up",-1),M=i("br",null,null,-1),Z=c(" Sign Up "),$={class:"pt-2 text-center"},L={class:"text-secondary"},O=c('Click "Sign Up" button means you agree our '),T=c("Agreement"),Y={key:1,class:"card-body"},j=i("h6",{class:"text-center"},"Sign Up",-1),G=i("br",null,null,-1),Q=c(" Verify "),X={setup(H){const _={username:[{required:!0,message:"Username is required"}],email:[{required:!0,message:"Email is required"},{validator:(d,e)=>{if(!new RegExp(/^\w+((.\w+)|(-\w+))@[A-Za-z0-9]+((.|-)[A-Za-z0-9]+).[A-Za-z0-9]+$/).test(e))return new Error("Please enter the vaild email")}}],password:[{required:!0,message:"Password is required"}],confirmPassword:[{required:!0,message:"Please enter the password again"},{validator:(d,e)=>{if(e!==s.password)return new Error("The confirm password isn't match")}}],verifyCode:[{required:!0,message:"Verify Code is required"}]},S=P(),b=U.create({validateStatus:()=>!0}),o=N(),n=w(!1),v=w(null),g=w(0),s=V({email:"",username:"",password:"",confirmPassword:"",agreement:!1,verifyCode:""});function q(){var d;(d=v.value)==null||d.validate(e=>{e||(n.value=!0,b.post("/api/management/users",{username:s.username,password:s.password,email:s.email}).catch(()=>{o.error("Failed to sign up, request error, detail in the developer console."),n.value=!1}).then(a=>{a.status===201?(o.success("Sign up successfully, we send a email to your inbox, please check it then to active your account."),g.value++):a.data.error==="DataError#2"?o.warning("Your email has been registered, please login."):a.data.error==="DataError#1"?o.warning("Your username has been used, please change."):a.data.error==="ServerError#1"?(console.error(a.data.message),o.error("Failed to sign up, server database error, detail in the developer console.")):a.data.error==="ServerError#2"?(console.error(a.data.message),o.error("Failed to sign up, server mailer error, detail in the developer console.")):o.error("Something went wrong, please try again later"),n.value=!1}))})}function E(){var d;(d=v.value)==null||d.validate(e=>{e||(n.value=!0,b.post(`/api/management/users?verify=${s.verifyCode}`).catch(()=>{o.error("Failed to verify, request error, detail in the developer console."),n.value=!1}).then(a=>{a.status===200?(o.success("Verify successfully! Register completed! Please login."),S.push({name:"user.login"})):a.data.error==="DataError"?o.warning("Invaild verify code, please check it again. Or go back register again."):a.data.error==="ServerError"?(console.error(a.data.message),o.error("Failed to sign up, server database error, detail in the developer console.")):o.error("Something went wrong, please try again later"),n.value=!1}))})}return(d,e)=>(y(),h("div",A,[i("div",R,[z,i("div",B,[g.value===0?(y(),h("div",D,[I,M,t(r(k),{ref_key:"form",ref:v,model:r(s),rules:_},{default:l(()=>[t(r(u),{label:"Username",path:"username"},{default:l(()=>[t(r(f),{value:r(s).username,"onUpdate:value":e[0]||(e[0]=a=>r(s).username=a),onKeydown:e[1]||(e[1]=m(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(u),{label:"Email",path:"email"},{default:l(()=>[t(r(f),{value:r(s).email,"onUpdate:value":e[2]||(e[2]=a=>r(s).email=a),onKeydown:e[3]||(e[3]=m(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(u),{label:"Password",path:"password"},{default:l(()=>[t(r(f),{value:r(s).password,"onUpdate:value":e[4]||(e[4]=a=>r(s).password=a),type:"password",onKeydown:e[5]||(e[5]=m(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(u),{label:"Confirm Password",path:"confirmPassword"},{default:l(()=>[t(r(f),{value:r(s).confirmPassword,"onUpdate:value":e[6]||(e[6]=a=>r(s).confirmPassword=a),type:"password",onKeydown:e[7]||(e[7]=m(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(x),{loading:n.value,style:{width:"100%"},type:"primary",onClick:q},{default:l(()=>[Z]),_:1},8,["loading"]),i("div",$,[i("span",L,[O,t(r(F),{to:{name:"agreement",query:{page:"user"}}},{default:l(()=>[T]),_:1})])])]),_:1},8,["model"])])):C("",!0),g.value===1?(y(),h("div",Y,[j,G,t(r(k),{ref_key:"form",ref:v,model:r(s),rules:_},{default:l(()=>[t(r(u),{label:"Verify Code",path:"verifyCode"},{default:l(()=>[t(r(f),{value:r(s).verifyCode,"onUpdate:value":e[8]||(e[8]=a=>r(s).verifyCode=a),onKeydown:e[9]||(e[9]=m(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(x),{loading:n.value,style:{width:"100%"},type:"primary",onClick:E},{default:l(()=>[Q]),_:1},8,["loading"])]),_:1},8,["model"])])):C("",!0)])])]))}};export{X as default};
