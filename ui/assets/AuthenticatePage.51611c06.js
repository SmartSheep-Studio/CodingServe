import{e as C,u as I,a as v,D as x,g as B,f as F,I as g,r as L,h as r,q as u,l as t,p as i,t as s,m as o,k as b,j as y,F as N,y as Q,a6 as R,v as D,M as E}from"./vendor.d8a6652f.js";import{u as P,_ as V}from"./index.aa82df17.js";import{L as A}from"./VueElementLoading.common.885381f6.js";const M={class:"container-fluid row",style:{height:"100%"}},j={class:"col-lg-4 col-md-5 col-sm-6 position-absolute top-50 start-50 translate-middle"},z=t("h4",{class:"text-center",style:{"line-height":"60px"}},[t("img",{alt:"LumbaShark",height:"80",src:V,width:"80"})],-1),T={key:0,class:"card"},G={class:"card-body text-center"},H={key:1,class:"card text-white bg-danger mb-3"},J={class:"card-body"},K={class:"text-center"},O=t("hr",null,null,-1),U={class:"card-text"},W={class:"text-white",href:"https://fed.smartsheep.space/t/faq"},X={class:"text-white",href:"https://discord.gg/F4SgsEfQQ3"},Y=t("a",{class:"text-white",href:"mailto:littlesheep.code@hotmail.com"},[t("b",null,"littlesheep.code@hotmail.com")],-1),Z={key:2,class:"card"},tt={class:"card-body pb-0"},et={class:"text-center"},st=["src"],at={class:"text-secondary"},ot=t("br",null,null,-1),nt=t("hr",null,null,-1),lt={class:"card-body pt-0"},it={class:"text-center"},ct={class:"list-group"},rt={class:"list-group-item"},ut=t("input",{disabled:"",checked:"checked",class:"form-check-input me-1",type:"checkbox"},null,-1),dt={class:"pt-3"},ht={type:"button",class:"btn btn-secondary float-start",style:{width:"49%"}},pt=t("br",null,null,-1),_t=t("br",null,null,-1),mt={class:"text-center"},ft={class:"text-secondary"},vt={id:"loading"},$t={setup(gt){const{t:h}=C(),{cookies:$}=I(),p=v.create({validateStatus:()=>!0}),_=x(),d=P(),w=B(),m=F(),a=g(!1),k=g({}),n=g({});function q(){a.value=!0,p.post("/api/oauth",{client_id:m.query.client_id},{headers:{Authorization:"Bearer "+$.get("access_token")}}).then(e=>{a.value=!1,e.status===200?window.location.href=m.query.redirect_uri+"?code="+e.data.code:(_.error(h("common.messages.request-unknown-error")),console.error("Request response: ",e),a.value=!1)}).catch(e=>{_.error(h("common.messages.request-unknown-error")),console.error(e.message),a.value=!1})}function S(){a.value=!0;const e=p.get("/api/oauth",{params:m.query}),c=p.get("/api/management/developer/scopes");v.all([e,c]).then(v.spread((...l)=>{l[0].status===200||l[0].status===400?(n.value=l[0].data,k.value=l[1].data.data,a.value=!1):(_.error(h("common.messages.request-unknown-error")),console.error("Request response errors: ",l),a.value=!1)}))}return S(),(e,c)=>{const l=L("router-link");return r(),u("div",M,[t("div",j,[z,a.value||i(d).status.pulling?(r(),u("div",T,[t("div",G,[t("span",null,[t("b",null,s(e.$t("common.loading")),1)])])])):n.value.error?(r(),u("div",H,[t("div",J,[t("div",K,[t("h6",null,s(e.$t("oauth.authenticate.failed.title")),1),t("span",null,s(n.value.error),1)]),O,t("div",U,[o(s(e.$t("oauth.authenticate.failed.description.0"))+" ",1),t("ol",null,[t("li",null,s(e.$t("oauth.authenticate.failed.description.1")),1),t("li",null,s(e.$t("oauth.authenticate.failed.description.2")),1),t("li",null,[o(s(e.$t("oauth.authenticate.failed.description.3"))+" ",1),t("a",W,[t("b",null,s(e.$t("oauth.authenticate.failed.description.4")),1)])]),t("li",null,[o(s(e.$t("oauth.authenticate.failed.description.5"))+" ",1),t("a",X,[t("b",null,s(e.$t("oauth.authenticate.failed.description.6")),1)])]),t("li",null,[o(s(e.$t("oauth.authenticate.failed.description.7"))+" ",1),Y])]),o(" "+s(e.$t("oauth.authenticate.failed.description.8"))+" ",1),b(l,{to:{name:"introduce"},class:"text-white",href:"https://discord.gg/F4SgsEfQQ3"},{default:y(()=>[t("b",null,s(e.$t("oauth.authenticate.failed.description.9")),1)]),_:1})])])])):(r(),u("div",Z,[t("div",tt,[t("div",et,[t("div",null,[t("img",{src:n.value.client.avatar,class:"rounded-circle",width:"42",height:"42"},null,8,st)]),t("span",null,[o(s(n.value.client.client_name)+" ",1),t("span",at,s(n.value.developer.username),1)]),ot,t("span",null,s(e.$t("oauth.authenticate.want")),1)])]),nt,t("div",lt,[t("h6",it,s(e.$t("oauth.authenticate.required")),1),t("div",null,[t("ul",ct,[(r(!0),u(N,null,Q(n.value.client.scope.split(","),f=>(r(),u("li",rt,[ut,t("span",null,"\xA0"+s(k.value.details[f]),1)]))),256))])]),t("div",dt,[b(i(R),{onPositiveClick:c[0]||(c[0]=f=>i(w).push({name:"introduce"}))},{trigger:y(()=>[t("button",ht,s(e.$t("common.actions.cancel")),1)]),default:y(()=>[o(" "+s(e.$t("oauth.authenticate.cancel")),1)]),_:1}),t("button",{type:"button",class:"btn btn-success float-end",style:{width:"49%"},onClick:c[1]||(c[1]=f=>q())},s(e.$t("oauth.authenticate.grant")),1),pt,_t,t("div",mt,[t("span",ft,[o(s(e.$t("oauth.authenticate.grant-tip"))+" ",1),t("b",null,s(i(d).account.accountProfile.username),1)])])])])]))]),D(t("div",vt,[b(i(A),{active:a.value||i(d).status.pulling,"is-full-screen":""},null,8,["active"])],512),[[E,a.value||i(d).status.pulling]])])}}};export{$t as default};
