import{u as Z,a as N,L as E,e as P,Q as u,r as Q,a2 as f,a3 as W,i as X,s as Y,v as D,x as M,q as l,m as n,t as c,p,l as a,a4 as b,k as o,Z as w,a5 as j,a6 as G,a7 as H,a8 as U,a9 as F,aa as K,V as C,X as S,W as I,Y as z,S as J}from"./vendor.87e1a7ff.js";import{L as O}from"./VueElementLoading.common.f9eb4760.js";import{u as x}from"./index.f03dac3d.js";const ee={class:"container"},te={class:"alert alert-success"},le={class:"alert-heading"},ae=n("hr",null,null,-1),ne={class:"mb-0"},se={id:"statistics-display",class:"row mb-3"},re={class:"col-3"},oe={class:"col-3"},ie=n("i",{class:"bi bi-plus-circle"},null,-1),ce=p("\xA0 "),de=n("i",{class:"bi bi-arrow-clockwise"},null,-1),ue={class:"pt-2",id:"clients-display"},pe={class:"pt-2"},ve={id:"loading"},he={setup(me){const{cookies:h}=Z(),y=N.create({validateStatus:()=>!0}),d=E(),{t:s}=P(),q=x(),g=u(!1),A=u(null),r=Q({clientName:"",scope:"",avatar:"",response:{display:!1,clientId:"",clientSecret:""}}),L={clientName:[{required:!0,message:s("developer.center.new-client.validate.client-name")}],scope:[{required:!0,message:s("developer.center.new-client.validate.scope")}],avatar:[{required:!0,message:s("developer.center.new-client.validate.avatar")},{validator:(e,t)=>{if(!new RegExp(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/).test(t))return new Error(s("developer.center.new-client.validate.avatar-invalid"))}}]},v=u(!1),m=u(!1),_=u([]),B=u({}),R=[{title:s("developer.center.client.avatar"),key:"avatar",render(e){return f("img",{width:32,height:32,class:"rounded-3",src:e.avatar})}},{title:s("developer.center.client.client-name"),key:"client_name"},{title:s("developer.center.client.client-id"),key:"client_id",render(e){return f("code",{onClick:()=>k(e.client_id)},e.client_id)}},{title:s("developer.center.client.scope"),key:"scope",render(e){return e.scope.split(",").map(i=>f(H,{style:{marginRight:"6px"},type:"info"},{default:()=>i}))}},{title:s("developer.center.client.created-at"),key:"created_at",render(e){return f("span",new Date(e.created_at).toLocaleString())}},{title:s("developer.center.client.action"),key:"actions",render(e){return f(w,{onClick:()=>V(e.client_id),strong:!0,size:"small",type:"error"},{default:()=>s("common.actions.delete")})}}];function k(e){W(e,void 0,t=>{t?(d.error(s("common.messages.copy-failed")),console.error(t)):d.success(s("common.messages.copy-success"))})}function T(){A.value.validate(e=>{e||(v.value=!0,y.put("/api/management/developer/client",{client_name:r.clientName,scope:r.scope,avatar:r.avatar},{headers:{Authorization:"Bearer "+h.get("access_token")}}).catch(()=>{d.error(s("common.messages.request-unknown-error")),v.value=!1}).then(t=>{t.status===400?(d.warning(s("developer.center.messages.invalid")),v.value=!1):(d.success(s("developer.center.messages.success")),r.response.display=!0,r.response.clientId=t.data.client.client_id,r.response.clientSecret=t.data.client.client_secret,g.value=!1,v.value=!1,$())}))})}function V(e){confirm(s("developer.center.messages.confirm"))&&(console.log(e),y.delete("/api/management/developer/client?id="+e,{headers:{Authorization:"Bearer "+h.get("access_token")}}).then(()=>{d.success(s("developer.center.messages.deleted.0")+e.substring(0,8)+s("developer.center.messages.deleted.1")),$()}))}function $(){m.value=!0;const e=y.get("/api/management/developer/client",{headers:{Authorization:"Bearer "+h.get("access_token")}});N.all([e]).then(N.spread((...t)=>{t[0].status===200?(B.value=t[0].data.statistics,_.value=t[0].data.data,m.value=!1):(d.error(s("common.messages.request-unknown-error")),console.error("Request response errors: ",t),m.value=!1)}))}return $(),(e,t)=>(X(),Y("div",ee,[D(n("div",te,[n("div",null,[n("h4",le,c(e.$t("developer.center.new-client-success.title")),1),n("p",null,c(e.$t("developer.center.new-client-success.description")),1),ae,n("p",ne,[n("div",null,[p(c(e.$t("developer.center.client.client-id"))+": ",1),n("code",{onClick:t[0]||(t[0]=i=>k(l(r).response.clientId))},c(l(r).response.clientId),1)]),n("div",null,[p(c(e.$t("developer.center.client.client-secret"))+": ",1),n("code",{onClick:t[1]||(t[1]=i=>k(l(r).response.clientSecret))},c(l(r).response.clientSecret),1)])])])],512),[[M,l(r).response.display]]),n("div",null,[n("h3",null,c(e.$t("developer.center.title")),1),n("h4",null,c(e.$t("developer.center.statistics")),1),n("div",se,[n("div",re,[a(l(b),null,{default:o(()=>[a(l(U),{label:e.$t("developer.center.statistic.grant-count")},{default:o(()=>[a(l(F),{from:0,to:B.value.grantedUsers},null,8,["to"])]),_:1},8,["label"])]),_:1})]),n("div",oe,[a(l(b),null,{default:o(()=>[a(l(U),{label:e.$t("developer.center.statistic.registered-clients")},{default:o(()=>[a(l(F),{from:0,to:_.value.length},null,8,["to"])]),_:1},8,["label"])]),_:1})])]),n("h4",null,c(e.$t("developer.center.clients")),1),a(l(w),{onClick:t[2]||(t[2]=i=>g.value=!0)},{icon:o(()=>[a(l(K),null,{default:o(()=>[ie]),_:1})]),default:o(()=>[p(c(e.$t("developer.center.new")),1)]),_:1}),ce,a(l(w),{onClick:t[3]||(t[3]=i=>this.$router.go())},{icon:o(()=>[a(l(K),null,{default:o(()=>[de]),_:1})]),default:o(()=>[p(c(e.$t("developer.center.reload")),1)]),_:1}),n("div",ue,[n("div",pe,[a(l(j),{columns:R,data:_.value,pagination:{pageSize:10}},null,8,["data"])]),a(l(G),{show:g.value,"onUpdate:show":t[10]||(t[10]=i=>g.value=i)},{default:o(()=>[a(l(b),{style:{width:"600px"},title:e.$t("developer.center.new-client.title"),bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:o(()=>[a(l(J),{ref_key:"newForm",ref:A,model:l(r),rules:L},{default:o(()=>[a(l(C),{label:e.$t("developer.center.new-client.client-name"),path:"clientName"},{default:o(()=>[a(l(S),{value:l(r).clientName,"onUpdate:value":t[4]||(t[4]=i=>l(r).clientName=i),onKeydown:t[5]||(t[5]=I(z(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["label"]),a(l(C),{label:e.$t("developer.center.new-client.scope"),path:"scope"},{default:o(()=>[a(l(S),{value:l(r).scope,"onUpdate:value":t[6]||(t[6]=i=>l(r).scope=i),placeholder:e.$t("developer.center.new-client.placeholders.scope"),onKeydown:t[7]||(t[7]=I(z(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),a(l(C),{label:e.$t("developer.center.new-client.avatar"),path:"avatar"},{default:o(()=>[a(l(S),{value:l(r).avatar,"onUpdate:value":t[8]||(t[8]=i=>l(r).avatar=i),placeholder:e.$t("developer.center.new-client.placeholders.avatar"),onKeydown:t[9]||(t[9]=I(z(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),a(l(w),{loading:v.value,style:{width:"100%"},type:"primary",onClick:T},{default:o(()=>[p(c(e.$t("common.actions.create")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])])]),D(n("div",ve,[a(l(O),{active:m.value||l(q).status.pulling,"is-full-screen":""},null,8,["active"])],512),[[M,m.value||l(q).status.pulling]])]))}};export{he as default};
